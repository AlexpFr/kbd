<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<title>The Linux keyboard and console HOWTO: Delete and Backspace</title>
	</head>
	<body class="container">
		<nav>
			<ul class="pagination">
				<li class="page-item"><a class="page-link" href="kbd-4.html">Previous</a></li>
				<li class="page-item"><a class="page-link" href="kbd-6.html">Next</a></li>
			</ul>
		</nav>

		<div class="page-header">
			<h2><a name="s5">Delete and Backspace</a></h2>
		</div>

		<p>Getting Delete and Backspace to work just right is nontrivial,
		especially in a mixed environment, where you talk to console,
		to <code>X</code>, to <code>bash</code>, to <code>emacs</code>, login remotely, etc.
		You may have to edit several configuration files to tell all
		of the programs involved precisely what you want.
		On the one hand, there is the matter of which keys generate
		which codes (and how these codes are remapped by e.g. <code>kermit</code>
		or <code>emacs</code>), and on the other hand the question of what functions
		are bound to what codes.</p>

		<p>People often complain `my backspace key does not work', as if this
		key had a built-in function `delete previous character'.
		Unfortunately, all this key, or any key, does is producing a code,
		and one only can hope that the kernel tty driver and
		all application programs can be configured such that
		the backspace key indeed does function as a `delete previous character'
		key.</p>

		<p>Most Unix programs get their tty input via the kernel tty driver
		in `cooked' mode, and a simple <code>stty</code> command determines the
		erase character. However, programs like <code>bash</code> and <code>emacs</code>
		and <code>X</code> do their own input handling, and have to be convinced
		one-by-one to do the right thing.</p>

		<div class="page-header">
			<h3><a name="ss5.1">How to tell Unix what character you want to use to delete the last typed character</a></h3>
		</div>

		<p>
		<pre>
        % stty erase ^?
</pre>

		If the character is erased, but in a funny way, then something is
		wrong with your tty settings. If <code>echoprt</code> is set, then erased characters
		are enclosed between <code>\</code> and <code>/</code>.
		If <code>echoe</code> is not set, then the erase char is echoed
		(which is reasonable when it is a printing character, like #).
		Most people will want <code>stty echoe -echoprt</code>. Saying <code>stty sane</code>
		will do this and more. Saying <code>stty -a</code> shows your current settings.
		How come this is not right by default? It is, if you use the right
		<code>getty</code>.</p>

		<p>Note that many programs (like <code>bash</code>, <code>emacs</code> etc.) have their own
		keybindings (defined in <code>~/.inputrc</code>,
		<code>~/.emacs</code> etc.) and are unaffected by the setting
		of the erase character.</p>

		<p>The standard Unix tty driver does not recognize a cursor, or keys
		(like the arrow keys) to move the current position, and hence does not
		have a command `delete current character' either. But for example
		you can get <code>bash</code> on the console to recognize the Delete key by putting
		<pre>
        set editing-mode emacs
        "\e[3~":delete-char
</pre>
		into <code>~/.inputrc</code>.</p>

		<h4>`Getty used to do the right thing with DEL and BS but is broken now?'</h4>

		<p>Earlier, the console driver would do BS Space BS
		(<code>\010\040\010</code>)
		when it got a DEL (<code>\177</code>).
		Nowadays, DEL's are ignored (as they should be,
		since the driver emulates a vt100). Get a better getty, i.e.,
		one that does not output DEL.</p>

		<h4>`Login behaves differently at the first and second login attempts?'</h4>

		<p>At the first attempt, you are talking to <code>getty</code>. At the second attempt,
		you are talking to <code>login</code>, a different program.</p>

		<div class="page-header">
			<h3><a name="ss5.2">How to tell Linux what code to generate when a key is pressed</a></h3>
		</div>

		<p>On the console, or, more precisely, when not in (MEDIUM)RAW mode, use
		<pre>
        % loadkeys mykeys.map
</pre>

		and under X use
		<pre>
        % xmodmap mykeys.xmap
</pre>

		Note that (since XFree86-2.1) X reads the Linux settings of the keymaps
		when initialising the X keymap. Although the two systems are not
		100% compatible, this should mean that in many cases the use of
		<code>xmodmap</code> has become superfluous.</p>

		<p>For example, suppose that you would like the Backspace key
		to send a BackSpace (Ctrl-H, octal 010) and the grey Delete key
		a DEL (octal 0177). Add the following to <code>/etc/rc.local</code>
		(or wherever you keep your local boot-time stuff):
		<pre>
        /usr/bin/loadkeys &lt;&lt; EOF
        keycode 14 = BackSpace
        keycode 111 = Delete
        EOF
</pre>

		Note that this will only change the function of these keys
		when no modifiers are used. (You need to specify a keymaps line
		to tell which keymaps should be affected if you want to change
		bindings on more keymaps.)
		The Linux kernel default lets
		Ctrl-Backspace generate BackSpace - this is sometimes useful
		as emergency escape, when you find you can only generate DELs.</p>

		<p>The left Alt key is sometimes called the Meta key, and by
		default the combinations AltL-X are bound to the symbol MetaX.
		But what character sequence is MetaX?
		That is determined (per-tty) by the Meta flag, set by the command
		<code>setmetamode</code>. The two choices are: ESC X or X or-ed with 0200.</p>

		<p>Many distributions have a <code>loadkeys</code> command somewhere in the
		bootup sequence. For example, one may have the name of the desired
		keymap in <code>/etc/sysconfig/keyboard</code> and the <code>loadkeys</code>
		command that loads it in <code>/etc/rc.d/init.d/keytable</code>.
		Or one may have the actual default keymap in <code>/etc/default.keytab</code>
		and the loadkeys command that loads it in <code>/etc/rc.d/boot</code>.
		Etc. Instead of adding a local modification to the default, one can
		of course change the default by editing the default keymap or changing
		the name of the keymap to be loaded at boot time. Note that <code>loadkeys</code>
		itself has default keymap <code>defkeymap.map</code> located somewhere under
		<code>/usr/lib/kbd</code> or <code>/usr/share/kbd</code> (just like all other
		keymaps) and this may not yet be available in single user boot before
		<code>/usr</code> has been mounted.</p>

		<h4>`How do I get a dvorak keyboard?'</h4>

		<p>The command
		<pre>
        % loadkeys dvorak
</pre>

		will give you a dvorak layout, probably by loading
		something like <code>/usr/lib/kbd/keymaps/i386/dvorak/dvorak.map.gz</code>.
		Under <code>X</code>, put
		<pre>
        XkbLayout       "dvorak"
</pre>

		in <code>XF86Config</code>.</p>

		<h4>`Why doesn't the Backspace key generate BackSpace by default?'</h4>

		<p>(i) Because the VT100 had a Delete key above the Enter key.</p>
		<p>(ii) Because Linus decided so.</p>

		<div class="page-header">
			<h3><a name="ss5.3">How to tell X to interchange Delete and Backspace</a></h3>
		</div>

		<p>
		<pre>
        % xmodmap -e "keysym BackSpace = Delete" -e "keysym Delete = BackSpace"
</pre>

		Or, if you just want the Backspace key to generate a BackSpace:
		<pre>
        % xmodmap -e "keycode 22 = BackSpace"
</pre>

		Or, if you just want the Delete key to generate a Delete:
		<pre>
        % xmodmap -e "keycode 107 = Delete"
</pre>

		(but usually this is the default binding already).</p>

		<div class="page-header">
			<h3><a name="ss5.4">How to tell emacs what to do when it receives a Delete or Backspace</a></h3>
		</div>

		<p>Put in your <code>.emacs</code> file lines like
		<pre>
        (global-set-key "\?" 'help-command)
        (global-set-key "\C-h" 'delete-backward-char)
</pre>

		Of course you can bind other commands to other keys in the same way.
		Note that various major and minor modes redefine keybindings.
		For example, in incremental search mode one finds the code
		<pre>
        (define-key map "\177" 'isearch-delete-char)
        (define-key map "\C-h" 'isearch-mode-help)
</pre>

		This means that it may be a bad idea to use the above two
		global-set-key commands. There are too many places where
		there are built-in assumptions about Ctrl-H = help and DEL = delete.
		That doesn't mean that you have to setup keys so that Backspace
		generates DEL. But if it doesn't then it is easiest to remap
		them at the lowest possible level in emacs.</p>

		<div class="page-header">
			<h3><a name="ss5.5">How to tell emacs to interchange Delete and Backspace</a></h3>
		</div>

		<p>Put in your <code>.emacs</code> file lines
		<pre>
        (setq keyboard-translate-table (make-string 128 0))
        (let ((i 0))
          (while (&lt; i 128)
            (aset keyboard-translate-table i i)
            (setq i (1+ i))))
        (aset keyboard-translate-table ?\b ?\^?)
        (aset keyboard-translate-table ?\^? ?\b)
</pre>

		Recent versions of emacs have a function <code>keyboard-translate</code>
		and one may simplify the above to
		<pre>
        (keyboard-translate ?\C-h ?\C-?)
        (keyboard-translate ?\C-? ?\C-h)
</pre>

		Note that under X emacs can distinguish between Ctrl-h and the
		Backspace key (regardless of what codes these produce on the console),
		and by default emacs will view the Backspace key as DEL
		(and do deletion things, as bound to that character, rather than
		help things, bound to Ctrl-H). One can distinguish Backspace and Delete,
		e.g. by
		<pre>
        (global-unset-key [backspace] )
        (global-set-key [backspace] 'delete-backward-char)
        (global-unset-key [delete] )
        (global-set-key [delete] 'delete-char)
</pre>
		</p>

		<div class="page-header">
			<h3><a name="ss5.6">How to tell kermit to interchange Delete and Backspace</a></H2></a></h3>
		</div>

		<p>Put in your <code>.kermrc</code> file the lines
		<pre>
        set key \127 \8
        set key \8 \127
</pre>
		</p>

		<div class="page-header">
			<h3><a name="ss5.7">How to tell xterm to interchange Delete and Backspace</a></h3>
		</div>

		<p>
		<pre>
XTerm*VT100.Translations:       #override\n\
        &lt;KeyPress> BackSpace : string(0x7f)\n\
        &lt;KeyPress> Delete : string(0x08)\n
</pre>
		</p>

		<div class="page-header">
			<h3><a name="ss5.8">How to tell xterm about your favourite tty modes</a></h3>
		</div>

		<p>Normally xterm will inherit the tty modes from its invoker.
		Under <code>xdm</code>, the default erase and kill characters are <code>#</code> and <code>@</code>,
		as in good old Unix Version 6.
		If you don't like that, you might put something like
		<pre>
        XTerm*ttymodes: erase ^? kill ^U intr ^C quit ^\ eof ^D \ 
                        susp ^Z start ^Q stop ^S eol ^@
</pre>

		in <code>/usr/lib/X11/app-defaults/XTerm</code> or in
		<code>$HOME/.Xresources</code>, assuming that you have a line
		<pre>
        xrdb -merge $HOME/.Xresources
</pre>

		in your <code>$HOME/.xinitrc</code> or <code>$HOME/.xsession</code>.</p>

		<div class="page-header">
			<h3><a name="ss5.9">How to tell non-Motif X applications that the Del key deletes forward</a></h3>
		</div>

		<p>Put
		<pre>
*Text.translations:    #override \
        ~Shift ~Meta &lt;Key>Delete: delete-next-character()
</pre>

		into <code>.Xresources</code> to make non-Motif X applications such as
		<code>xfig</code>, <code>xedit</code>, etc., work correctly. (Daniel T. Cobra)</p>

		<div class="page-header">
			<h3><a name="ss5.10">How to tell xmosaic that the Backspace key generates a DEL</a></h3>
		</div>

		<p>Putting
		<pre>
        *XmText.translations: #override\n\
           &lt;Key>osfDelete: delete-previous-character()
        *XmTextField.translations: #override\n\
           &lt;Key>osfDelete: delete-previous-character()
</pre>

		in your <code>$HOME/.Xdefaults</code> or
		<code>$HOME/.Xresources</code> helps.
		(What file? The file that is fed to <code>xrdb</code>, for example
		in <code>.xinitrc</code>.)</p>

		<p>The netscape FAQ, however, says:
		<pre>
        Why doesn't my Backspace key work in text fields? 
        By default, Linux and XFree86 come with the Backspace and Delete keys
        misconfigured. All Motif programs (including, of course, Netscape
        Navigator) will malfunction in the same way.

        The Motif spec says that Backspace is supposed to delete the previous
        character and Delete is supposed to delete the following character.
        Linux and XFree86 come configured with both the Backspace and Delete
        keys generating Delete.

        You can fix this by using any one of the xmodmap, xkeycaps, or
        loadkeys programs to make the key in question generate the BackSpace
        keysym instead of Delete.

        You can also fix it by having a .motifbind file; see the man page
        for VirtualBindings(3).

        Note: Don't use the *XmText.translations or *XmTextField.translations
        resources to attempt to fix this problem. If you do, you will blow
        away Netscape Navigator's other text-field key bindings.
</pre>
		</p>

		<div class="page-header">
			<h3><a name="ss5.11">A better solution for Motif-using programs, like netscape</a></h3>
		</div>

		<p>Ted Kandell (<code>ted@tcg.net</code>) suggests the following:</p>
		<p>Somewhere in your .profile add the following:
		<pre>
stty erase ^H
</pre>

		If you are using <code>bash</code>, add the following lines to your <code>.inputrc</code>:
		<pre>
"\C-?": delete-char
"\C-h": backward-delete-char
</pre>

		Add the following lines to your .xinitrc file:
		<pre>
xmodmap &lt;&lt;-EOF
keycode 22  =  BackSpace osfBackSpace
keycode 107 =  Delete
EOF

# start your window manager here,  for example:
#(fvwm) 2>&amp;1 | tee /dev/tty /dev/console

stty sane
stty erase ^H
loadmap &lt;&lt;-EOF
keycode 14  = BackSpace
keycode 111 = Delete
EOF
</pre>
		</p>

		<p>This will definitely work for a PC 101 or 102 key keyboard
		with any Linux/XFree86 layout.</p>

		<p>The important part to making Motif apps like Netscape work properly
		is adding osfBackSpace to keycode 22 in addition to BackSpace.</p>

		<p>Note that there must be spaces on either side of the = sign.</p>

		<div class="page-header">
			<h3><a name="ss5.12">What about termcap and terminfo?</a></h3>
		</div>

		<p>When people have problems with backspace, they tend to look at their termcap
		(or terminfo) entry for the terminal, and indeed, there does exist a kb
		(or kbs) capability describing the code generated by the Backspace key.
		However, not many programs use it, so unless you are having problems with one
		particular program only, probably the fault is elsewhere.
		Of course it is a good idea anyway to correct your termcap (terminfo) entry.
		See also below under "The TERM variable".</p>

		<div class="page-header">
			<h3><a name="ss5.13">A complete solution</a></h3>
		</div>

		<p>There are many possibilities to get a functioning system.
		Can't you give one complete set of settings that works?</p>

		<p>One way of getting a setup that works in all contexts
		is to have the Backspace key generate DEL when on the
		console (or xterm), and BackSpace when under X.
		Maybe that is most convenient - there are too many X utilities
		that expect BackSpace, and emacs on the console or xterm
		expects DEL, while emacs under X can distinguish [BackSpace]
		from Ctrl-H and does the right thing.</p>

		<p>What is needed?
		No loadkeys changes, since the Backspace key already generates
		DEL by default.  No stty settings, they are OK by default.
		No X settings, they are OK by default.
		One just has to tell xterm that the Backspace key should generate DEL:
		put
		<pre>
XTerm*VT100.Translations:       #override\n\
        &lt;KeyPress> BackSpace : string(0x7f)\n\
</pre>

		in <code>.Xresources</code>, and
		<pre>
xrdb -merge .Xresources
</pre>

		in <code>.xinitrc</code>, and you are settled.</p>

		<p>For a much more extensive discussion of these things, and
		alternative solutions, see <a href="http://www.ibb.net/~anne/keyboard.html">Anne Baretta's page</a>.</p>

		<hr/>
		<nav>
			<ul class="pagination">
				<li class="page-item"><a class="page-link" href="kbd-4.html">Previous</a></li>
				<li class="page-item"><a class="page-link" href="kbd-6.html">Next</a></li>
			</ul>
		</nav>
	</body>
</html>
